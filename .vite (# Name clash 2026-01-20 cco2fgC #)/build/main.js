"use strict";const T=require("electron"),Y=require("node:path"),Se=require("path"),ae=require("child_process"),je=require("tty"),Ee=require("util"),we=require("fs"),Pe=require("net"),pe=require("crypto");var ce=typeof document<"u"?document.currentScript:null;function Ce(g){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(g){for(const b in g)if(b!=="default"){const j=Object.getOwnPropertyDescriptor(g,b);Object.defineProperty(l,b,j.get?j:{enumerable:!0,get:()=>g[b]})}}return l.default=g,Object.freeze(l)}const Q=Ce(we);var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Me(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var fe={exports:{}},re={exports:{}},oe={exports:{}},ue,de;function Ae(){if(de)return ue;de=1;var g=1e3,l=g*60,b=l*60,j=b*24,c=j*365.25;ue=function(n,o){o=o||{};var i=typeof n;if(i==="string"&&n.length>0)return f(n);if(i==="number"&&isNaN(n)===!1)return o.long?r(n):e(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function f(n){if(n=String(n),!(n.length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(n);if(o){var i=parseFloat(o[1]),a=(o[2]||"ms").toLowerCase();switch(a){case"years":case"year":case"yrs":case"yr":case"y":return i*c;case"days":case"day":case"d":return i*j;case"hours":case"hour":case"hrs":case"hr":case"h":return i*b;case"minutes":case"minute":case"mins":case"min":case"m":return i*l;case"seconds":case"second":case"secs":case"sec":case"s":return i*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function e(n){return n>=j?Math.round(n/j)+"d":n>=b?Math.round(n/b)+"h":n>=l?Math.round(n/l)+"m":n>=g?Math.round(n/g)+"s":n+"ms"}function r(n){return t(n,j,"day")||t(n,b,"hour")||t(n,l,"minute")||t(n,g,"second")||n+" ms"}function t(n,o,i){if(!(n<o))return n<o*1.5?Math.floor(n/o)+" "+i:Math.ceil(n/o)+" "+i+"s"}return ue}var he;function _e(){return he||(he=1,function(g,l){l=g.exports=c.debug=c.default=c,l.coerce=t,l.disable=e,l.enable=f,l.enabled=r,l.humanize=Ae(),l.names=[],l.skips=[],l.formatters={};var b;function j(n){var o=0,i;for(i in n)o=(o<<5)-o+n.charCodeAt(i),o|=0;return l.colors[Math.abs(o)%l.colors.length]}function c(n){function o(){if(o.enabled){var i=o,a=+new Date,s=a-(b||a);i.diff=s,i.prev=b,i.curr=a,b=a;for(var u=new Array(arguments.length),d=0;d<u.length;d++)u[d]=arguments[d];u[0]=l.coerce(u[0]),typeof u[0]!="string"&&u.unshift("%O");var p=0;u[0]=u[0].replace(/%([a-zA-Z%])/g,function(x,A){if(x==="%%")return x;p++;var O=l.formatters[A];if(typeof O=="function"){var _=u[p];x=O.call(i,_),u.splice(p,1),p--}return x}),l.formatArgs.call(i,u);var w=o.log||l.log||console.log.bind(console);w.apply(i,u)}}return o.namespace=n,o.enabled=l.enabled(n),o.useColors=l.useColors(),o.color=j(n),typeof l.init=="function"&&l.init(o),o}function f(n){l.save(n),l.names=[],l.skips=[];for(var o=(typeof n=="string"?n:"").split(/[\s,]+/),i=o.length,a=0;a<i;a++)o[a]&&(n=o[a].replace(/\*/g,".*?"),n[0]==="-"?l.skips.push(new RegExp("^"+n.substr(1)+"$")):l.names.push(new RegExp("^"+n+"$")))}function e(){l.enable("")}function r(n){var o,i;for(o=0,i=l.skips.length;o<i;o++)if(l.skips[o].test(n))return!1;for(o=0,i=l.names.length;o<i;o++)if(l.names[o].test(n))return!0;return!1}function t(n){return n instanceof Error?n.stack||n.message:n}}(oe,oe.exports)),oe.exports}var ve;function Te(){return ve||(ve=1,function(g,l){l=g.exports=_e(),l.log=c,l.formatArgs=j,l.save=f,l.load=e,l.useColors=b,l.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:r(),l.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function b(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}l.formatters.j=function(t){try{return JSON.stringify(t)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}};function j(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+l.humanize(this.diff),!!n){var o="color: "+this.color;t.splice(1,0,o,"color: inherit");var i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,function(s){s!=="%%"&&(i++,s==="%c"&&(a=i))}),t.splice(a,0,o)}}function c(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function f(t){try{t==null?l.storage.removeItem("debug"):l.storage.debug=t}catch{}}function e(){var t;try{t=l.storage.debug}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}l.enable(e());function r(){try{return window.localStorage}catch{}}}(re,re.exports)),re.exports}var ie={exports:{}},me;function qe(){return me||(me=1,function(g,l){var b=je,j=Ee;l=g.exports=_e(),l.init=a,l.log=t,l.formatArgs=r,l.save=n,l.load=o,l.useColors=e,l.colors=[6,2,3,4,5,1],l.inspectOpts=Object.keys(process.env).filter(function(s){return/^debug_/i.test(s)}).reduce(function(s,u){var d=u.substring(6).toLowerCase().replace(/_([a-z])/g,function(w,x){return x.toUpperCase()}),p=process.env[u];return/^(yes|on|true|enabled)$/i.test(p)?p=!0:/^(no|off|false|disabled)$/i.test(p)?p=!1:p==="null"?p=null:p=Number(p),s[d]=p,s},{});var c=parseInt(process.env.DEBUG_FD,10)||2;c!==1&&c!==2&&j.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var f=c===1?process.stdout:c===2?process.stderr:i(c);function e(){return"colors"in l.inspectOpts?!!l.inspectOpts.colors:b.isatty(c)}l.formatters.o=function(s){return this.inspectOpts.colors=this.useColors,j.inspect(s,this.inspectOpts).split(`
`).map(function(u){return u.trim()}).join(" ")},l.formatters.O=function(s){return this.inspectOpts.colors=this.useColors,j.inspect(s,this.inspectOpts)};function r(s){var u=this.namespace,d=this.useColors;if(d){var p=this.color,w="  \x1B[3"+p+";1m"+u+" \x1B[0m";s[0]=w+s[0].split(`
`).join(`
`+w),s.push("\x1B[3"+p+"m+"+l.humanize(this.diff)+"\x1B[0m")}else s[0]=new Date().toUTCString()+" "+u+" "+s[0]}function t(){return f.write(j.format.apply(j,arguments)+`
`)}function n(s){s==null?delete process.env.DEBUG:process.env.DEBUG=s}function o(){return process.env.DEBUG}function i(s){var u,d=process.binding("tty_wrap");switch(d.guessHandleType(s)){case"TTY":u=new b.WriteStream(s),u._type="tty",u._handle&&u._handle.unref&&u._handle.unref();break;case"FILE":var p=we;u=new p.SyncWriteStream(s,{autoClose:!1}),u._type="fs";break;case"PIPE":case"TCP":var w=Pe;u=new w.Socket({fd:s,readable:!1,writable:!0}),u.readable=!1,u.read=null,u._type="pipe",u._handle&&u._handle.unref&&u._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return u.fd=s,u._isStdio=!0,u}function a(s){s.inspectOpts={};for(var u=Object.keys(l.inspectOpts),d=0;d<u.length;d++)s.inspectOpts[u[d]]=l.inspectOpts[u[d]]}l.enable(o())}(ie,ie.exports)),ie.exports}typeof process<"u"&&process.type==="renderer"?fe.exports=Te():fe.exports=qe();var Re=fe.exports,le=Se,Ie=ae.spawn,be=Re("electron-squirrel-startup"),se=T.app,ye=function(g,l){var b=le.resolve(le.dirname(process.execPath),"..","Update.exe");be("Spawning `%s` with args `%s`",b,g),Ie(b,g,{detached:!0}).on("close",l)},De=function(){if(process.platform==="win32"){var g=process.argv[1];be("processing squirrel command `%s`",g);var l=le.basename(process.execPath);if(g==="--squirrel-install"||g==="--squirrel-updated")return ye(["--createShortcut="+l],se.quit),!0;if(g==="--squirrel-uninstall")return ye(["--removeShortcut="+l],se.quit),!0;if(g==="--squirrel-obsolete")return se.quit(),!0}return!1},Fe=De();const Ue=Me(Fe);var xe={exports:{}};(function(g,l){(function(b,j){g.exports=j(ae,pe)})(ke,function(b,j){return function(c){function f(r){if(e[r])return e[r].exports;var t=e[r]={exports:{},id:r,loaded:!1};return c[r].call(t.exports,t,t.exports,f),t.loaded=!0,t.exports}var e={};return f.m=c,f.c=e,f.p="",f(0)}([function(c,f,e){c.exports=e(34)},function(c,f,e){var r=e(29)("wks"),t=e(33),n=e(2).Symbol,o=typeof n=="function",i=c.exports=function(a){return r[a]||(r[a]=o&&n[a]||(o?n:t)("Symbol."+a))};i.store=r},function(c,f){var e=c.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(c,f,e){var r=e(9);c.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(c,f,e){c.exports=!e(24)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(c,f,e){var r=e(12),t=e(17);c.exports=e(4)?function(n,o,i){return r.f(n,o,t(1,i))}:function(n,o,i){return n[o]=i,n}},function(c,f){var e=c.exports={version:"2.4.0"};typeof __e=="number"&&(__e=e)},function(c,f,e){var r=e(14);c.exports=function(t,n,o){if(r(t),n===void 0)return t;switch(o){case 1:return function(i){return t.call(n,i)};case 2:return function(i,a){return t.call(n,i,a)};case 3:return function(i,a,s){return t.call(n,i,a,s)}}return function(){return t.apply(n,arguments)}}},function(c,f){var e={}.hasOwnProperty;c.exports=function(r,t){return e.call(r,t)}},function(c,f){c.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(c,f){c.exports={}},function(c,f){var e={}.toString;c.exports=function(r){return e.call(r).slice(8,-1)}},function(c,f,e){var r=e(3),t=e(26),n=e(32),o=Object.defineProperty;f.f=e(4)?Object.defineProperty:function(i,a,s){if(r(i),a=n(a,!0),r(s),t)try{return o(i,a,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(i[a]=s.value),i}},function(c,f,e){var r=e(42),t=e(15);c.exports=function(n){return r(t(n))}},function(c,f){c.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(c,f){c.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(c,f,e){var r=e(9),t=e(2).document,n=r(t)&&r(t.createElement);c.exports=function(o){return n?t.createElement(o):{}}},function(c,f){c.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},function(c,f,e){var r=e(12).f,t=e(8),n=e(1)("toStringTag");c.exports=function(o,i,a){o&&!t(o=a?o:o.prototype,n)&&r(o,n,{configurable:!0,value:i})}},function(c,f,e){var r=e(29)("keys"),t=e(33);c.exports=function(n){return r[n]||(r[n]=t(n))}},function(c,f){var e=Math.ceil,r=Math.floor;c.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(c,f,e){var r=e(11),t=e(1)("toStringTag"),n=r(function(){return arguments}())=="Arguments",o=function(i,a){try{return i[a]}catch{}};c.exports=function(i){var a,s,u;return i===void 0?"Undefined":i===null?"Null":typeof(s=o(a=Object(i),t))=="string"?s:n?r(a):(u=r(a))=="Object"&&typeof a.callee=="function"?"Arguments":u}},function(c,f){c.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(c,f,e){var r=e(2),t=e(6),n=e(7),o=e(5),i="prototype",a=function(s,u,d){var p,w,x,A=s&a.F,O=s&a.G,_=s&a.S,S=s&a.P,k=s&a.B,m=s&a.W,E=O?t:t[u]||(t[u]={}),P=E[i],M=O?r:_?r[u]:(r[u]||{})[i];O&&(d=u);for(p in d)w=!A&&M&&M[p]!==void 0,w&&p in E||(x=w?M[p]:d[p],E[p]=O&&typeof M[p]!="function"?d[p]:k&&w?n(x,r):m&&M[p]==x?function(q){var U=function(L,I,W){if(this instanceof q){switch(arguments.length){case 0:return new q;case 1:return new q(L);case 2:return new q(L,I)}return new q(L,I,W)}return q.apply(this,arguments)};return U[i]=q[i],U}(x):S&&typeof x=="function"?n(Function.call,x):x,S&&((E.virtual||(E.virtual={}))[p]=x,s&a.R&&P&&!P[p]&&o(P,p,x)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,c.exports=a},function(c,f){c.exports=function(e){try{return!!e()}catch{return!0}}},function(c,f,e){c.exports=e(2).document&&document.documentElement},function(c,f,e){c.exports=!e(4)&&!e(24)(function(){return Object.defineProperty(e(16)("div"),"a",{get:function(){return 7}}).a!=7})},function(c,f,e){var r=e(28),t=e(23),n=e(57),o=e(5),i=e(8),a=e(10),s=e(45),u=e(18),d=e(52),p=e(1)("iterator"),w=!([].keys&&"next"in[].keys()),x="@@iterator",A="keys",O="values",_=function(){return this};c.exports=function(S,k,m,E,P,M,q){s(m,k,E);var U,L,I,W=function(v){if(!w&&v in D)return D[v];switch(v){case A:return function(){return new m(this,v)};case O:return function(){return new m(this,v)}}return function(){return new m(this,v)}},J=k+" Iterator",z=P==O,V=!1,D=S.prototype,B=D[p]||D[x]||P&&D[P],F=B||W(P),X=P?z?W("entries"):F:void 0,h=k=="Array"&&D.entries||B;if(h&&(I=d(h.call(new S)),I!==Object.prototype&&(u(I,J,!0),r||i(I,p)||o(I,p,_))),z&&B&&B.name!==O&&(V=!0,F=function(){return B.call(this)}),r&&!q||!w&&!V&&D[p]||o(D,p,F),a[k]=F,a[J]=_,P)if(U={values:z?F:W(O),keys:M?F:W(A),entries:X},q)for(L in U)L in D||n(D,L,U[L]);else t(t.P+t.F*(w||V),k,U);return U}},function(c,f){c.exports=!0},function(c,f,e){var r=e(2),t="__core-js_shared__",n=r[t]||(r[t]={});c.exports=function(o){return n[o]||(n[o]={})}},function(c,f,e){var r,t,n,o=e(7),i=e(41),a=e(25),s=e(16),u=e(2),d=u.process,p=u.setImmediate,w=u.clearImmediate,x=u.MessageChannel,A=0,O={},_="onreadystatechange",S=function(){var m=+this;if(O.hasOwnProperty(m)){var E=O[m];delete O[m],E()}},k=function(m){S.call(m.data)};p&&w||(p=function(m){for(var E=[],P=1;arguments.length>P;)E.push(arguments[P++]);return O[++A]=function(){i(typeof m=="function"?m:Function(m),E)},r(A),A},w=function(m){delete O[m]},e(11)(d)=="process"?r=function(m){d.nextTick(o(S,m,1))}:x?(t=new x,n=t.port2,t.port1.onmessage=k,r=o(n.postMessage,n,1)):u.addEventListener&&typeof postMessage=="function"&&!u.importScripts?(r=function(m){u.postMessage(m+"","*")},u.addEventListener("message",k,!1)):r=_ in s("script")?function(m){a.appendChild(s("script"))[_]=function(){a.removeChild(this),S.call(m)}}:function(m){setTimeout(o(S,m,1),0)}),c.exports={set:p,clear:w}},function(c,f,e){var r=e(20),t=Math.min;c.exports=function(n){return n>0?t(r(n),9007199254740991):0}},function(c,f,e){var r=e(9);c.exports=function(t,n){if(!r(t))return t;var o,i;if(n&&typeof(o=t.toString)=="function"&&!r(i=o.call(t))||typeof(o=t.valueOf)=="function"&&!r(i=o.call(t))||!n&&typeof(o=t.toString)=="function"&&!r(i=o.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(c,f){var e=0,r=Math.random();c.exports=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++e+r).toString(36))}},function(c,f,e){function r(_){return _&&_.__esModule?_:{default:_}}function t(){return process.platform!=="win32"?"":process.arch==="ia32"&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"mixed":"native"}function n(_){return(0,p.createHash)("sha256").update(_).digest("hex")}function o(_){switch(x){case"darwin":return _.split("IOPlatformUUID")[1].split(`
`)[0].replace(/\=|\s+|\"/gi,"").toLowerCase();case"win32":return _.toString().split("REG_SZ")[1].replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"linux":return _.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"freebsd":return _.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();default:throw new Error("Unsupported platform: "+process.platform)}}function i(_){var S=o((0,d.execSync)(O[x]).toString());return _?S:n(S)}function a(_){return new u.default(function(S,k){return(0,d.exec)(O[x],{},function(m,E,P){if(m)return k(new Error("Error while obtaining machine id: "+m.stack));var M=o(E.toString());return S(_?M:n(M))})})}Object.defineProperty(f,"__esModule",{value:!0});var s=e(35),u=r(s);f.machineIdSync=i,f.machineId=a;var d=e(70),p=e(71),w=process,x=w.platform,A={native:"%windir%\\System32",mixed:"%windir%\\sysnative\\cmd.exe /c %windir%\\System32"},O={darwin:"ioreg -rd1 -c IOPlatformExpertDevice",win32:A[t()]+"\\REG.exe QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",linux:"( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :",freebsd:"kenv -q smbios.system.uuid || sysctl -n kern.hostuuid"}},function(c,f,e){c.exports={default:e(36),__esModule:!0}},function(c,f,e){e(66),e(68),e(69),e(67),c.exports=e(6).Promise},function(c,f){c.exports=function(){}},function(c,f){c.exports=function(e,r,t,n){if(!(e instanceof r)||n!==void 0&&n in e)throw TypeError(t+": incorrect invocation!");return e}},function(c,f,e){var r=e(13),t=e(31),n=e(62);c.exports=function(o){return function(i,a,s){var u,d=r(i),p=t(d.length),w=n(s,p);if(o&&a!=a){for(;p>w;)if(u=d[w++],u!=u)return!0}else for(;p>w;w++)if((o||w in d)&&d[w]===a)return o||w||0;return!o&&-1}}},function(c,d,e){var r=e(7),t=e(44),n=e(43),o=e(3),i=e(31),a=e(64),s={},u={},d=c.exports=function(p,w,x,A,O){var _,S,k,m,E=O?function(){return p}:a(p),P=r(x,A,w?2:1),M=0;if(typeof E!="function")throw TypeError(p+" is not iterable!");if(n(E)){for(_=i(p.length);_>M;M++)if(m=w?P(o(S=p[M])[0],S[1]):P(p[M]),m===s||m===u)return m}else for(k=E.call(p);!(S=k.next()).done;)if(m=t(k,P,S.value,w),m===s||m===u)return m};d.BREAK=s,d.RETURN=u},function(c,f){c.exports=function(e,r,t){var n=t===void 0;switch(r.length){case 0:return n?e():e.call(t);case 1:return n?e(r[0]):e.call(t,r[0]);case 2:return n?e(r[0],r[1]):e.call(t,r[0],r[1]);case 3:return n?e(r[0],r[1],r[2]):e.call(t,r[0],r[1],r[2]);case 4:return n?e(r[0],r[1],r[2],r[3]):e.call(t,r[0],r[1],r[2],r[3])}return e.apply(t,r)}},function(c,f,e){var r=e(11);c.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return r(t)=="String"?t.split(""):Object(t)}},function(c,f,e){var r=e(10),t=e(1)("iterator"),n=Array.prototype;c.exports=function(o){return o!==void 0&&(r.Array===o||n[t]===o)}},function(c,f,e){var r=e(3);c.exports=function(t,n,o,i){try{return i?n(r(o)[0],o[1]):n(o)}catch(s){var a=t.return;throw a!==void 0&&r(a.call(t)),s}}},function(c,f,e){var r=e(49),t=e(17),n=e(18),o={};e(5)(o,e(1)("iterator"),function(){return this}),c.exports=function(i,a,s){i.prototype=r(o,{next:t(1,s)}),n(i,a+" Iterator")}},function(c,f,e){var r=e(1)("iterator"),t=!1;try{var n=[7][r]();n.return=function(){t=!0},Array.from(n,function(){throw 2})}catch{}c.exports=function(o,i){if(!i&&!t)return!1;var a=!1;try{var s=[7],u=s[r]();u.next=function(){return{done:a=!0}},s[r]=function(){return u},o(s)}catch{}return a}},function(c,f){c.exports=function(e,r){return{value:r,done:!!e}}},function(c,f,e){var r=e(2),t=e(30).set,n=r.MutationObserver||r.WebKitMutationObserver,o=r.process,i=r.Promise,a=e(11)(o)=="process";c.exports=function(){var s,u,d,p=function(){var O,_;for(a&&(O=o.domain)&&O.exit();s;){_=s.fn,s=s.next;try{_()}catch(S){throw s?d():u=void 0,S}}u=void 0,O&&O.enter()};if(a)d=function(){o.nextTick(p)};else if(n){var w=!0,x=document.createTextNode("");new n(p).observe(x,{characterData:!0}),d=function(){x.data=w=!w}}else if(i&&i.resolve){var A=i.resolve();d=function(){A.then(p)}}else d=function(){t.call(r,p)};return function(O){var _={fn:O,next:void 0};u&&(u.next=_),s||(s=_,d()),u=_}}},function(c,f,e){var r=e(3),t=e(50),n=e(22),o=e(19)("IE_PROTO"),i=function(){},a="prototype",s=function(){var u,d=e(16)("iframe"),p=n.length,w=">";for(d.style.display="none",e(25).appendChild(d),d.src="javascript:",u=d.contentWindow.document,u.open(),u.write("<script>document.F=Object<\/script"+w),u.close(),s=u.F;p--;)delete s[a][n[p]];return s()};c.exports=Object.create||function(u,d){var p;return u!==null?(i[a]=r(u),p=new i,i[a]=null,p[o]=u):p=s(),d===void 0?p:t(p,d)}},function(c,f,e){var r=e(12),t=e(3),n=e(54);c.exports=e(4)?Object.defineProperties:function(o,i){t(o);for(var a,s=n(i),u=s.length,d=0;u>d;)r.f(o,a=s[d++],i[a]);return o}},function(c,f,e){var r=e(55),t=e(17),n=e(13),o=e(32),i=e(8),a=e(26),s=Object.getOwnPropertyDescriptor;f.f=e(4)?s:function(u,d){if(u=n(u),d=o(d,!0),a)try{return s(u,d)}catch{}if(i(u,d))return t(!r.f.call(u,d),u[d])}},function(c,f,e){var r=e(8),t=e(63),n=e(19)("IE_PROTO"),o=Object.prototype;c.exports=Object.getPrototypeOf||function(i){return i=t(i),r(i,n)?i[n]:typeof i.constructor=="function"&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?o:null}},function(c,f,e){var r=e(8),t=e(13),n=e(39)(!1),o=e(19)("IE_PROTO");c.exports=function(i,a){var s,u=t(i),d=0,p=[];for(s in u)s!=o&&r(u,s)&&p.push(s);for(;a.length>d;)r(u,s=a[d++])&&(~n(p,s)||p.push(s));return p}},function(c,f,e){var r=e(53),t=e(22);c.exports=Object.keys||function(n){return r(n,t)}},function(c,f){f.f={}.propertyIsEnumerable},function(c,f,e){var r=e(5);c.exports=function(t,n,o){for(var i in n)o&&t[i]?t[i]=n[i]:r(t,i,n[i]);return t}},function(c,f,e){c.exports=e(5)},function(c,f,e){var r=e(9),t=e(3),n=function(o,i){if(t(o),!r(i)&&i!==null)throw TypeError(i+": can't set as prototype!")};c.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(o,i,a){try{a=e(7)(Function.call,e(51).f(Object.prototype,"__proto__").set,2),a(o,[]),i=!(o instanceof Array)}catch{i=!0}return function(s,u){return n(s,u),i?s.__proto__=u:a(s,u),s}}({},!1):void 0),check:n}},function(c,f,e){var r=e(2),t=e(6),n=e(12),o=e(4),i=e(1)("species");c.exports=function(a){var s=typeof t[a]=="function"?t[a]:r[a];o&&s&&!s[i]&&n.f(s,i,{configurable:!0,get:function(){return this}})}},function(c,f,e){var r=e(3),t=e(14),n=e(1)("species");c.exports=function(o,i){var a,s=r(o).constructor;return s===void 0||(a=r(s)[n])==null?i:t(a)}},function(c,f,e){var r=e(20),t=e(15);c.exports=function(n){return function(o,i){var a,s,u=String(t(o)),d=r(i),p=u.length;return d<0||d>=p?n?"":void 0:(a=u.charCodeAt(d),a<55296||a>56319||d+1===p||(s=u.charCodeAt(d+1))<56320||s>57343?n?u.charAt(d):a:n?u.slice(d,d+2):(a-55296<<10)+(s-56320)+65536)}}},function(c,f,e){var r=e(20),t=Math.max,n=Math.min;c.exports=function(o,i){return o=r(o),o<0?t(o+i,0):n(o,i)}},function(c,f,e){var r=e(15);c.exports=function(t){return Object(r(t))}},function(c,f,e){var r=e(21),t=e(1)("iterator"),n=e(10);c.exports=e(6).getIteratorMethod=function(o){if(o!=null)return o[t]||o["@@iterator"]||n[r(o)]}},function(c,f,e){var r=e(37),t=e(47),n=e(10),o=e(13);c.exports=e(27)(Array,"Array",function(i,a){this._t=o(i),this._i=0,this._k=a},function(){var i=this._t,a=this._k,s=this._i++;return!i||s>=i.length?(this._t=void 0,t(1)):a=="keys"?t(0,s):a=="values"?t(0,i[s]):t(0,[s,i[s]])},"values"),n.Arguments=n.Array,r("keys"),r("values"),r("entries")},function(c,f){},function(c,f,e){var r,t,n,o=e(28),i=e(2),a=e(7),s=e(21),u=e(23),d=e(9),p=(e(3),e(14)),w=e(38),x=e(40),A=(e(58).set,e(60)),O=e(30).set,_=e(48)(),S="Promise",k=i.TypeError,E=i.process,m=i[S],E=i.process,P=s(E)=="process",M=function(){},q=!!function(){try{var h=m.resolve(1),v=(h.constructor={})[e(1)("species")]=function(y){y(M,M)};return(P||typeof PromiseRejectionEvent=="function")&&h.then(M)instanceof v}catch{}}(),U=function(h,v){return h===v||h===m&&v===n},L=function(h){var v;return!(!d(h)||typeof(v=h.then)!="function")&&v},I=function(h){return U(m,h)?new W(h):new t(h)},W=t=function(h){var v,y;this.promise=new h(function(C,R){if(v!==void 0||y!==void 0)throw k("Bad Promise constructor");v=C,y=R}),this.resolve=p(v),this.reject=p(y)},J=function(h){try{h()}catch(v){return{error:v}}},z=function(h,v){if(!h._n){h._n=!0;var y=h._c;_(function(){for(var C=h._v,R=h._s==1,H=0,K=function(G){var N,ne,$=R?G.ok:G.fail,ee=G.resolve,Z=G.reject,te=G.domain;try{$?(R||(h._h==2&&B(h),h._h=1),$===!0?N=C:(te&&te.enter(),N=$(C),te&&te.exit()),N===G.promise?Z(k("Promise-chain cycle")):(ne=L(N))?ne.call(N,ee,Z):ee(N)):Z(C)}catch(Oe){Z(Oe)}};y.length>H;)K(y[H++]);h._c=[],h._n=!1,v&&!h._h&&V(h)})}},V=function(h){O.call(i,function(){var v,y,C,R=h._v;if(D(h)&&(v=J(function(){P?E.emit("unhandledRejection",R,h):(y=i.onunhandledrejection)?y({promise:h,reason:R}):(C=i.console)&&C.error&&C.error("Unhandled promise rejection",R)}),h._h=P||D(h)?2:1),h._a=void 0,v)throw v.error})},D=function(h){if(h._h==1)return!1;for(var v,y=h._a||h._c,C=0;y.length>C;)if(v=y[C++],v.fail||!D(v.promise))return!1;return!0},B=function(h){O.call(i,function(){var v;P?E.emit("rejectionHandled",h):(v=i.onrejectionhandled)&&v({promise:h,reason:h._v})})},F=function(h){var v=this;v._d||(v._d=!0,v=v._w||v,v._v=h,v._s=2,v._a||(v._a=v._c.slice()),z(v,!0))},X=function(h){var v,y=this;if(!y._d){y._d=!0,y=y._w||y;try{if(y===h)throw k("Promise can't be resolved itself");(v=L(h))?_(function(){var C={_w:y,_d:!1};try{v.call(h,a(X,C,1),a(F,C,1))}catch(R){F.call(C,R)}}):(y._v=h,y._s=1,z(y,!1))}catch(C){F.call({_w:y,_d:!1},C)}}};q||(m=function(h){w(this,m,S,"_h"),p(h),r.call(this);try{h(a(X,this,1),a(F,this,1))}catch(v){F.call(this,v)}},r=function(h){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=e(56)(m.prototype,{then:function(h,v){var y=I(A(this,m));return y.ok=typeof h!="function"||h,y.fail=typeof v=="function"&&v,y.domain=P?E.domain:void 0,this._c.push(y),this._a&&this._a.push(y),this._s&&z(this,!1),y.promise},catch:function(h){return this.then(void 0,h)}}),W=function(){var h=new r;this.promise=h,this.resolve=a(X,h,1),this.reject=a(F,h,1)}),u(u.G+u.W+u.F*!q,{Promise:m}),e(18)(m,S),e(59)(S),n=e(6)[S],u(u.S+u.F*!q,S,{reject:function(h){var v=I(this),y=v.reject;return y(h),v.promise}}),u(u.S+u.F*(o||!q),S,{resolve:function(h){if(h instanceof m&&U(h.constructor,this))return h;var v=I(this),y=v.resolve;return y(h),v.promise}}),u(u.S+u.F*!(q&&e(46)(function(h){m.all(h).catch(M)})),S,{all:function(h){var v=this,y=I(v),C=y.resolve,R=y.reject,H=J(function(){var K=[],G=0,N=1;x(h,!1,function(ne){var $=G++,ee=!1;K.push(void 0),N++,v.resolve(ne).then(function(Z){ee||(ee=!0,K[$]=Z,--N||C(K))},R)}),--N||C(K)});return H&&R(H.error),y.promise},race:function(h){var v=this,y=I(v),C=y.reject,R=J(function(){x(h,!1,function(H){v.resolve(H).then(y.resolve,C)})});return R&&C(R.error),y.promise}})},function(c,f,e){var r=e(61)(!0);e(27)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,o=this._i;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o),this._i+=t.length,{value:t,done:!1})})},function(c,f,e){e(65);for(var r=e(2),t=e(5),n=e(10),o=e(1)("toStringTag"),i=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],a=0;a<5;a++){var s=i[a],u=r[s],d=u&&u.prototype;d&&!d[o]&&t(d,o,s),n[s]=n.Array}},function(c,f){c.exports=ae},function(c,f){c.exports=pe}])})})(xe);var Le=xe.exports;T.ipcMain.handle("get-machine-id",()=>Le.machineIdSync());T.ipcMain.handle("save-license",(g,l)=>{const b=T.app.getPath("userData"),j=Y.join(b,"license.txt");return Q.writeFileSync(j,l),!0});T.ipcMain.handle("get-license",()=>{const g=T.app.getPath("userData"),l=Y.join(g,"license.txt");return Q.existsSync(l)?Q.readFileSync(l,"utf-8"):null});Ue&&T.app.quit();const ge=()=>{new T.BrowserWindow({width:1300,height:800,webPreferences:{preload:Y.join(__dirname,"preload.js")}}).loadFile(Y.join(__dirname,"../renderer/main_window/index.html"))};function Ne(){return T.app.isPackaged?Y.dirname(T.app.getPath("exe")):process.cwd()}function We(){const g=Ne(),l=Y.join(g,"template.json"),b=Y.join(process.resourcesPath,"template.json");try{if(!Q.existsSync(l)){if(!Q.existsSync(b))throw new Error(`Bundled template not found at ${b}`);Q.copyFileSync(b,l)}}catch(j){console.error("Failed to ensure template.json:",j)}return l}T.app.whenReady().then(()=>{const g=We();T.ipcMain.handle("get-template-path",()=>g),ge(),T.app.on("activate",()=>{T.BrowserWindow.getAllWindows().length===0&&ge()})});T.app.on("window-all-closed",()=>{process.platform!=="darwin"&&T.app.quit()});T.ipcMain.handle("print-portrait",async(g,{content:l,url:b})=>{const j=new T.BrowserWindow({show:!1});process.env.NODE_ENV==="development"?b=imageSrc=new URL(b,void 0).toString():b=new URL(b,typeof document>"u"?require("url").pathToFileURL(__filename).href:ce&&ce.tagName.toUpperCase()==="SCRIPT"&&ce.src||new URL("main.js",document.baseURI).href).href;const f=`
<!DOCTYPE html>
<html dir="rtl">
<head>
  <meta charset="utf-8">
  <style>
    @page { size: A4 portrait; margin: 0; }
    html, body { margin: 0; padding: 0; width: 210mm; height: 297mm; overflow: hidden; }
    .print-area { 
      width: 210mm;
      height: 297mm;
      position: relative;
      background-image: url('${b}');
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
  </style>
</head>
<body>
  <div class="print-area">
    <img src='${imageSrc}' style="width:100%;height:auto" />

    ${l}
  </div>
</body>
</html>
  `;j.loadURL("data:text/html;charset=utf-8,"+encodeURIComponent(f)),j.webContents.on("did-finish-load",()=>{j.webContents.print({silent:!1,printBackground:!0,landscape:!1,margins:{marginType:"none"},pageSize:"A4"},()=>{j.close()})})});
