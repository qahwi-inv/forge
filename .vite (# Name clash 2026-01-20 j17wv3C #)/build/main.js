"use strict";const q=require("electron"),Y=require("node:path"),Oe=require("path"),se=require("child_process"),Se=require("tty"),je=require("util"),ge=require("fs"),Ee=require("net"),le=require("crypto");function Pe(g){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(g){for(const O in g)if(O!=="default"){const j=Object.getOwnPropertyDescriptor(g,O);Object.defineProperty(l,O,j.get?j:{enumerable:!0,get:()=>g[O]})}}return l.default=g,Object.freeze(l)}const Q=Pe(ge);var Ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ke(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var ae={exports:{}},re={exports:{}},oe={exports:{}},ue,pe;function Me(){if(pe)return ue;pe=1;var g=1e3,l=g*60,O=l*60,j=O*24,i=j*365.25;ue=function(n,o){o=o||{};var u=typeof n;if(u==="string"&&n.length>0)return f(n);if(u==="number"&&isNaN(n)===!1)return o.long?r(n):e(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function f(n){if(n=String(n),!(n.length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(n);if(o){var u=parseFloat(o[1]),a=(o[2]||"ms").toLowerCase();switch(a){case"years":case"year":case"yrs":case"yr":case"y":return u*i;case"days":case"day":case"d":return u*j;case"hours":case"hour":case"hrs":case"hr":case"h":return u*O;case"minutes":case"minute":case"mins":case"min":case"m":return u*l;case"seconds":case"second":case"secs":case"sec":case"s":return u*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}}}function e(n){return n>=j?Math.round(n/j)+"d":n>=O?Math.round(n/O)+"h":n>=l?Math.round(n/l)+"m":n>=g?Math.round(n/g)+"s":n+"ms"}function r(n){return t(n,j,"day")||t(n,O,"hour")||t(n,l,"minute")||t(n,g,"second")||n+" ms"}function t(n,o,u){if(!(n<o))return n<o*1.5?Math.floor(n/o)+" "+u:Math.ceil(n/o)+" "+u+"s"}return ue}var de;function we(){return de||(de=1,function(g,l){l=g.exports=i.debug=i.default=i,l.coerce=t,l.disable=e,l.enable=f,l.enabled=r,l.humanize=Me(),l.names=[],l.skips=[],l.formatters={};var O;function j(n){var o=0,u;for(u in n)o=(o<<5)-o+n.charCodeAt(u),o|=0;return l.colors[Math.abs(o)%l.colors.length]}function i(n){function o(){if(o.enabled){var u=o,a=+new Date,s=a-(O||a);u.diff=s,u.prev=O,u.curr=a,O=a;for(var c=new Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];c[0]=l.coerce(c[0]),typeof c[0]!="string"&&c.unshift("%O");var p=0;c[0]=c[0].replace(/%([a-zA-Z%])/g,function(_,A){if(_==="%%")return _;p++;var x=l.formatters[A];if(typeof x=="function"){var b=c[p];_=x.call(u,b),c.splice(p,1),p--}return _}),l.formatArgs.call(u,c);var w=o.log||l.log||console.log.bind(console);w.apply(u,c)}}return o.namespace=n,o.enabled=l.enabled(n),o.useColors=l.useColors(),o.color=j(n),typeof l.init=="function"&&l.init(o),o}function f(n){l.save(n),l.names=[],l.skips=[];for(var o=(typeof n=="string"?n:"").split(/[\s,]+/),u=o.length,a=0;a<u;a++)o[a]&&(n=o[a].replace(/\*/g,".*?"),n[0]==="-"?l.skips.push(new RegExp("^"+n.substr(1)+"$")):l.names.push(new RegExp("^"+n+"$")))}function e(){l.enable("")}function r(n){var o,u;for(o=0,u=l.skips.length;o<u;o++)if(l.skips[o].test(n))return!1;for(o=0,u=l.names.length;o<u;o++)if(l.names[o].test(n))return!0;return!1}function t(n){return n instanceof Error?n.stack||n.message:n}}(oe,oe.exports)),oe.exports}var he;function Ae(){return he||(he=1,function(g,l){l=g.exports=we(),l.log=i,l.formatArgs=j,l.save=f,l.load=e,l.useColors=O,l.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:r(),l.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function O(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}l.formatters.j=function(t){try{return JSON.stringify(t)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}};function j(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+l.humanize(this.diff),!!n){var o="color: "+this.color;t.splice(1,0,o,"color: inherit");var u=0,a=0;t[0].replace(/%[a-zA-Z%]/g,function(s){s!=="%%"&&(u++,s==="%c"&&(a=u))}),t.splice(a,0,o)}}function i(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function f(t){try{t==null?l.storage.removeItem("debug"):l.storage.debug=t}catch{}}function e(){var t;try{t=l.storage.debug}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}l.enable(e());function r(){try{return window.localStorage}catch{}}}(re,re.exports)),re.exports}var ie={exports:{}},ve;function qe(){return ve||(ve=1,function(g,l){var O=Se,j=je;l=g.exports=we(),l.init=a,l.log=t,l.formatArgs=r,l.save=n,l.load=o,l.useColors=e,l.colors=[6,2,3,4,5,1],l.inspectOpts=Object.keys(process.env).filter(function(s){return/^debug_/i.test(s)}).reduce(function(s,c){var d=c.substring(6).toLowerCase().replace(/_([a-z])/g,function(w,_){return _.toUpperCase()}),p=process.env[c];return/^(yes|on|true|enabled)$/i.test(p)?p=!0:/^(no|off|false|disabled)$/i.test(p)?p=!1:p==="null"?p=null:p=Number(p),s[d]=p,s},{});var i=parseInt(process.env.DEBUG_FD,10)||2;i!==1&&i!==2&&j.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var f=i===1?process.stdout:i===2?process.stderr:u(i);function e(){return"colors"in l.inspectOpts?!!l.inspectOpts.colors:O.isatty(i)}l.formatters.o=function(s){return this.inspectOpts.colors=this.useColors,j.inspect(s,this.inspectOpts).split(`
`).map(function(c){return c.trim()}).join(" ")},l.formatters.O=function(s){return this.inspectOpts.colors=this.useColors,j.inspect(s,this.inspectOpts)};function r(s){var c=this.namespace,d=this.useColors;if(d){var p=this.color,w="  \x1B[3"+p+";1m"+c+" \x1B[0m";s[0]=w+s[0].split(`
`).join(`
`+w),s.push("\x1B[3"+p+"m+"+l.humanize(this.diff)+"\x1B[0m")}else s[0]=new Date().toUTCString()+" "+c+" "+s[0]}function t(){return f.write(j.format.apply(j,arguments)+`
`)}function n(s){s==null?delete process.env.DEBUG:process.env.DEBUG=s}function o(){return process.env.DEBUG}function u(s){var c,d=process.binding("tty_wrap");switch(d.guessHandleType(s)){case"TTY":c=new O.WriteStream(s),c._type="tty",c._handle&&c._handle.unref&&c._handle.unref();break;case"FILE":var p=ge;c=new p.SyncWriteStream(s,{autoClose:!1}),c._type="fs";break;case"PIPE":case"TCP":var w=Ee;c=new w.Socket({fd:s,readable:!1,writable:!0}),c.readable=!1,c.read=null,c._type="pipe",c._handle&&c._handle.unref&&c._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return c.fd=s,c._isStdio=!0,c}function a(s){s.inspectOpts={};for(var c=Object.keys(l.inspectOpts),d=0;d<c.length;d++)s.inspectOpts[c[d]]=l.inspectOpts[c[d]]}l.enable(o())}(ie,ie.exports)),ie.exports}typeof process<"u"&&process.type==="renderer"?ae.exports=Ae():ae.exports=qe();var Te=ae.exports,fe=Oe,Re=se.spawn,be=Te("electron-squirrel-startup"),ce=q.app,ye=function(g,l){var O=fe.resolve(fe.dirname(process.execPath),"..","Update.exe");be("Spawning `%s` with args `%s`",O,g),Re(O,g,{detached:!0}).on("close",l)},Ie=function(){if(process.platform==="win32"){var g=process.argv[1];be("processing squirrel command `%s`",g);var l=fe.basename(process.execPath);if(g==="--squirrel-install"||g==="--squirrel-updated")return ye(["--createShortcut="+l],ce.quit),!0;if(g==="--squirrel-uninstall")return ye(["--removeShortcut="+l],ce.quit),!0;if(g==="--squirrel-obsolete")return ce.quit(),!0}return!1},Fe=Ie();const De=ke(Fe);var _e={exports:{}};(function(g,l){(function(O,j){g.exports=j(se,le)})(Ce,function(O,j){return function(i){function f(r){if(e[r])return e[r].exports;var t=e[r]={exports:{},id:r,loaded:!1};return i[r].call(t.exports,t,t.exports,f),t.loaded=!0,t.exports}var e={};return f.m=i,f.c=e,f.p="",f(0)}([function(i,f,e){i.exports=e(34)},function(i,f,e){var r=e(29)("wks"),t=e(33),n=e(2).Symbol,o=typeof n=="function",u=i.exports=function(a){return r[a]||(r[a]=o&&n[a]||(o?n:t)("Symbol."+a))};u.store=r},function(i,f){var e=i.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(i,f,e){var r=e(9);i.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(i,f,e){i.exports=!e(24)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(i,f,e){var r=e(12),t=e(17);i.exports=e(4)?function(n,o,u){return r.f(n,o,t(1,u))}:function(n,o,u){return n[o]=u,n}},function(i,f){var e=i.exports={version:"2.4.0"};typeof __e=="number"&&(__e=e)},function(i,f,e){var r=e(14);i.exports=function(t,n,o){if(r(t),n===void 0)return t;switch(o){case 1:return function(u){return t.call(n,u)};case 2:return function(u,a){return t.call(n,u,a)};case 3:return function(u,a,s){return t.call(n,u,a,s)}}return function(){return t.apply(n,arguments)}}},function(i,f){var e={}.hasOwnProperty;i.exports=function(r,t){return e.call(r,t)}},function(i,f){i.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(i,f){i.exports={}},function(i,f){var e={}.toString;i.exports=function(r){return e.call(r).slice(8,-1)}},function(i,f,e){var r=e(3),t=e(26),n=e(32),o=Object.defineProperty;f.f=e(4)?Object.defineProperty:function(u,a,s){if(r(u),a=n(a,!0),r(s),t)try{return o(u,a,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(u[a]=s.value),u}},function(i,f,e){var r=e(42),t=e(15);i.exports=function(n){return r(t(n))}},function(i,f){i.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(i,f){i.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(i,f,e){var r=e(9),t=e(2).document,n=r(t)&&r(t.createElement);i.exports=function(o){return n?t.createElement(o):{}}},function(i,f){i.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},function(i,f,e){var r=e(12).f,t=e(8),n=e(1)("toStringTag");i.exports=function(o,u,a){o&&!t(o=a?o:o.prototype,n)&&r(o,n,{configurable:!0,value:u})}},function(i,f,e){var r=e(29)("keys"),t=e(33);i.exports=function(n){return r[n]||(r[n]=t(n))}},function(i,f){var e=Math.ceil,r=Math.floor;i.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(i,f,e){var r=e(11),t=e(1)("toStringTag"),n=r(function(){return arguments}())=="Arguments",o=function(u,a){try{return u[a]}catch{}};i.exports=function(u){var a,s,c;return u===void 0?"Undefined":u===null?"Null":typeof(s=o(a=Object(u),t))=="string"?s:n?r(a):(c=r(a))=="Object"&&typeof a.callee=="function"?"Arguments":c}},function(i,f){i.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(i,f,e){var r=e(2),t=e(6),n=e(7),o=e(5),u="prototype",a=function(s,c,d){var p,w,_,A=s&a.F,x=s&a.G,b=s&a.S,S=s&a.P,k=s&a.B,y=s&a.W,E=x?t:t[c]||(t[c]={}),P=E[u],M=x?r:b?r[c]:(r[c]||{})[u];x&&(d=c);for(p in d)w=!A&&M&&M[p]!==void 0,w&&p in E||(_=w?M[p]:d[p],E[p]=x&&typeof M[p]!="function"?d[p]:k&&w?n(_,r):y&&M[p]==_?function(T){var L=function(U,I,B){if(this instanceof T){switch(arguments.length){case 0:return new T;case 1:return new T(U);case 2:return new T(U,I)}return new T(U,I,B)}return T.apply(this,arguments)};return L[u]=T[u],L}(_):S&&typeof _=="function"?n(Function.call,_):_,S&&((E.virtual||(E.virtual={}))[p]=_,s&a.R&&P&&!P[p]&&o(P,p,_)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,i.exports=a},function(i,f){i.exports=function(e){try{return!!e()}catch{return!0}}},function(i,f,e){i.exports=e(2).document&&document.documentElement},function(i,f,e){i.exports=!e(4)&&!e(24)(function(){return Object.defineProperty(e(16)("div"),"a",{get:function(){return 7}}).a!=7})},function(i,f,e){var r=e(28),t=e(23),n=e(57),o=e(5),u=e(8),a=e(10),s=e(45),c=e(18),d=e(52),p=e(1)("iterator"),w=!([].keys&&"next"in[].keys()),_="@@iterator",A="keys",x="values",b=function(){return this};i.exports=function(S,k,y,E,P,M,T){s(y,k,E);var L,U,I,B=function(v){if(!w&&v in F)return F[v];switch(v){case A:return function(){return new y(this,v)};case x:return function(){return new y(this,v)}}return function(){return new y(this,v)}},J=k+" Iterator",z=P==x,V=!1,F=S.prototype,N=F[p]||F[_]||P&&F[P],D=N||B(P),X=P?z?B("entries"):D:void 0,h=k=="Array"&&F.entries||N;if(h&&(I=d(h.call(new S)),I!==Object.prototype&&(c(I,J,!0),r||u(I,p)||o(I,p,b))),z&&N&&N.name!==x&&(V=!0,D=function(){return N.call(this)}),r&&!T||!w&&!V&&F[p]||o(F,p,D),a[k]=D,a[J]=b,P)if(L={values:z?D:B(x),keys:M?D:B(A),entries:X},T)for(U in L)U in F||n(F,U,L[U]);else t(t.P+t.F*(w||V),k,L);return L}},function(i,f){i.exports=!0},function(i,f,e){var r=e(2),t="__core-js_shared__",n=r[t]||(r[t]={});i.exports=function(o){return n[o]||(n[o]={})}},function(i,f,e){var r,t,n,o=e(7),u=e(41),a=e(25),s=e(16),c=e(2),d=c.process,p=c.setImmediate,w=c.clearImmediate,_=c.MessageChannel,A=0,x={},b="onreadystatechange",S=function(){var y=+this;if(x.hasOwnProperty(y)){var E=x[y];delete x[y],E()}},k=function(y){S.call(y.data)};p&&w||(p=function(y){for(var E=[],P=1;arguments.length>P;)E.push(arguments[P++]);return x[++A]=function(){u(typeof y=="function"?y:Function(y),E)},r(A),A},w=function(y){delete x[y]},e(11)(d)=="process"?r=function(y){d.nextTick(o(S,y,1))}:_?(t=new _,n=t.port2,t.port1.onmessage=k,r=o(n.postMessage,n,1)):c.addEventListener&&typeof postMessage=="function"&&!c.importScripts?(r=function(y){c.postMessage(y+"","*")},c.addEventListener("message",k,!1)):r=b in s("script")?function(y){a.appendChild(s("script"))[b]=function(){a.removeChild(this),S.call(y)}}:function(y){setTimeout(o(S,y,1),0)}),i.exports={set:p,clear:w}},function(i,f,e){var r=e(20),t=Math.min;i.exports=function(n){return n>0?t(r(n),9007199254740991):0}},function(i,f,e){var r=e(9);i.exports=function(t,n){if(!r(t))return t;var o,u;if(n&&typeof(o=t.toString)=="function"&&!r(u=o.call(t))||typeof(o=t.valueOf)=="function"&&!r(u=o.call(t))||!n&&typeof(o=t.toString)=="function"&&!r(u=o.call(t)))return u;throw TypeError("Can't convert object to primitive value")}},function(i,f){var e=0,r=Math.random();i.exports=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++e+r).toString(36))}},function(i,f,e){function r(b){return b&&b.__esModule?b:{default:b}}function t(){return process.platform!=="win32"?"":process.arch==="ia32"&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"mixed":"native"}function n(b){return(0,p.createHash)("sha256").update(b).digest("hex")}function o(b){switch(_){case"darwin":return b.split("IOPlatformUUID")[1].split(`
`)[0].replace(/\=|\s+|\"/gi,"").toLowerCase();case"win32":return b.toString().split("REG_SZ")[1].replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"linux":return b.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"freebsd":return b.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();default:throw new Error("Unsupported platform: "+process.platform)}}function u(b){var S=o((0,d.execSync)(x[_]).toString());return b?S:n(S)}function a(b){return new c.default(function(S,k){return(0,d.exec)(x[_],{},function(y,E,P){if(y)return k(new Error("Error while obtaining machine id: "+y.stack));var M=o(E.toString());return S(b?M:n(M))})})}Object.defineProperty(f,"__esModule",{value:!0});var s=e(35),c=r(s);f.machineIdSync=u,f.machineId=a;var d=e(70),p=e(71),w=process,_=w.platform,A={native:"%windir%\\System32",mixed:"%windir%\\sysnative\\cmd.exe /c %windir%\\System32"},x={darwin:"ioreg -rd1 -c IOPlatformExpertDevice",win32:A[t()]+"\\REG.exe QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",linux:"( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :",freebsd:"kenv -q smbios.system.uuid || sysctl -n kern.hostuuid"}},function(i,f,e){i.exports={default:e(36),__esModule:!0}},function(i,f,e){e(66),e(68),e(69),e(67),i.exports=e(6).Promise},function(i,f){i.exports=function(){}},function(i,f){i.exports=function(e,r,t,n){if(!(e instanceof r)||n!==void 0&&n in e)throw TypeError(t+": incorrect invocation!");return e}},function(i,f,e){var r=e(13),t=e(31),n=e(62);i.exports=function(o){return function(u,a,s){var c,d=r(u),p=t(d.length),w=n(s,p);if(o&&a!=a){for(;p>w;)if(c=d[w++],c!=c)return!0}else for(;p>w;w++)if((o||w in d)&&d[w]===a)return o||w||0;return!o&&-1}}},function(i,d,e){var r=e(7),t=e(44),n=e(43),o=e(3),u=e(31),a=e(64),s={},c={},d=i.exports=function(p,w,_,A,x){var b,S,k,y,E=x?function(){return p}:a(p),P=r(_,A,w?2:1),M=0;if(typeof E!="function")throw TypeError(p+" is not iterable!");if(n(E)){for(b=u(p.length);b>M;M++)if(y=w?P(o(S=p[M])[0],S[1]):P(p[M]),y===s||y===c)return y}else for(k=E.call(p);!(S=k.next()).done;)if(y=t(k,P,S.value,w),y===s||y===c)return y};d.BREAK=s,d.RETURN=c},function(i,f){i.exports=function(e,r,t){var n=t===void 0;switch(r.length){case 0:return n?e():e.call(t);case 1:return n?e(r[0]):e.call(t,r[0]);case 2:return n?e(r[0],r[1]):e.call(t,r[0],r[1]);case 3:return n?e(r[0],r[1],r[2]):e.call(t,r[0],r[1],r[2]);case 4:return n?e(r[0],r[1],r[2],r[3]):e.call(t,r[0],r[1],r[2],r[3])}return e.apply(t,r)}},function(i,f,e){var r=e(11);i.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return r(t)=="String"?t.split(""):Object(t)}},function(i,f,e){var r=e(10),t=e(1)("iterator"),n=Array.prototype;i.exports=function(o){return o!==void 0&&(r.Array===o||n[t]===o)}},function(i,f,e){var r=e(3);i.exports=function(t,n,o,u){try{return u?n(r(o)[0],o[1]):n(o)}catch(s){var a=t.return;throw a!==void 0&&r(a.call(t)),s}}},function(i,f,e){var r=e(49),t=e(17),n=e(18),o={};e(5)(o,e(1)("iterator"),function(){return this}),i.exports=function(u,a,s){u.prototype=r(o,{next:t(1,s)}),n(u,a+" Iterator")}},function(i,f,e){var r=e(1)("iterator"),t=!1;try{var n=[7][r]();n.return=function(){t=!0},Array.from(n,function(){throw 2})}catch{}i.exports=function(o,u){if(!u&&!t)return!1;var a=!1;try{var s=[7],c=s[r]();c.next=function(){return{done:a=!0}},s[r]=function(){return c},o(s)}catch{}return a}},function(i,f){i.exports=function(e,r){return{value:r,done:!!e}}},function(i,f,e){var r=e(2),t=e(30).set,n=r.MutationObserver||r.WebKitMutationObserver,o=r.process,u=r.Promise,a=e(11)(o)=="process";i.exports=function(){var s,c,d,p=function(){var x,b;for(a&&(x=o.domain)&&x.exit();s;){b=s.fn,s=s.next;try{b()}catch(S){throw s?d():c=void 0,S}}c=void 0,x&&x.enter()};if(a)d=function(){o.nextTick(p)};else if(n){var w=!0,_=document.createTextNode("");new n(p).observe(_,{characterData:!0}),d=function(){_.data=w=!w}}else if(u&&u.resolve){var A=u.resolve();d=function(){A.then(p)}}else d=function(){t.call(r,p)};return function(x){var b={fn:x,next:void 0};c&&(c.next=b),s||(s=b,d()),c=b}}},function(i,f,e){var r=e(3),t=e(50),n=e(22),o=e(19)("IE_PROTO"),u=function(){},a="prototype",s=function(){var c,d=e(16)("iframe"),p=n.length,w=">";for(d.style.display="none",e(25).appendChild(d),d.src="javascript:",c=d.contentWindow.document,c.open(),c.write("<script>document.F=Object<\/script"+w),c.close(),s=c.F;p--;)delete s[a][n[p]];return s()};i.exports=Object.create||function(c,d){var p;return c!==null?(u[a]=r(c),p=new u,u[a]=null,p[o]=c):p=s(),d===void 0?p:t(p,d)}},function(i,f,e){var r=e(12),t=e(3),n=e(54);i.exports=e(4)?Object.defineProperties:function(o,u){t(o);for(var a,s=n(u),c=s.length,d=0;c>d;)r.f(o,a=s[d++],u[a]);return o}},function(i,f,e){var r=e(55),t=e(17),n=e(13),o=e(32),u=e(8),a=e(26),s=Object.getOwnPropertyDescriptor;f.f=e(4)?s:function(c,d){if(c=n(c),d=o(d,!0),a)try{return s(c,d)}catch{}if(u(c,d))return t(!r.f.call(c,d),c[d])}},function(i,f,e){var r=e(8),t=e(63),n=e(19)("IE_PROTO"),o=Object.prototype;i.exports=Object.getPrototypeOf||function(u){return u=t(u),r(u,n)?u[n]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?o:null}},function(i,f,e){var r=e(8),t=e(13),n=e(39)(!1),o=e(19)("IE_PROTO");i.exports=function(u,a){var s,c=t(u),d=0,p=[];for(s in c)s!=o&&r(c,s)&&p.push(s);for(;a.length>d;)r(c,s=a[d++])&&(~n(p,s)||p.push(s));return p}},function(i,f,e){var r=e(53),t=e(22);i.exports=Object.keys||function(n){return r(n,t)}},function(i,f){f.f={}.propertyIsEnumerable},function(i,f,e){var r=e(5);i.exports=function(t,n,o){for(var u in n)o&&t[u]?t[u]=n[u]:r(t,u,n[u]);return t}},function(i,f,e){i.exports=e(5)},function(i,f,e){var r=e(9),t=e(3),n=function(o,u){if(t(o),!r(u)&&u!==null)throw TypeError(u+": can't set as prototype!")};i.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(o,u,a){try{a=e(7)(Function.call,e(51).f(Object.prototype,"__proto__").set,2),a(o,[]),u=!(o instanceof Array)}catch{u=!0}return function(s,c){return n(s,c),u?s.__proto__=c:a(s,c),s}}({},!1):void 0),check:n}},function(i,f,e){var r=e(2),t=e(6),n=e(12),o=e(4),u=e(1)("species");i.exports=function(a){var s=typeof t[a]=="function"?t[a]:r[a];o&&s&&!s[u]&&n.f(s,u,{configurable:!0,get:function(){return this}})}},function(i,f,e){var r=e(3),t=e(14),n=e(1)("species");i.exports=function(o,u){var a,s=r(o).constructor;return s===void 0||(a=r(s)[n])==null?u:t(a)}},function(i,f,e){var r=e(20),t=e(15);i.exports=function(n){return function(o,u){var a,s,c=String(t(o)),d=r(u),p=c.length;return d<0||d>=p?n?"":void 0:(a=c.charCodeAt(d),a<55296||a>56319||d+1===p||(s=c.charCodeAt(d+1))<56320||s>57343?n?c.charAt(d):a:n?c.slice(d,d+2):(a-55296<<10)+(s-56320)+65536)}}},function(i,f,e){var r=e(20),t=Math.max,n=Math.min;i.exports=function(o,u){return o=r(o),o<0?t(o+u,0):n(o,u)}},function(i,f,e){var r=e(15);i.exports=function(t){return Object(r(t))}},function(i,f,e){var r=e(21),t=e(1)("iterator"),n=e(10);i.exports=e(6).getIteratorMethod=function(o){if(o!=null)return o[t]||o["@@iterator"]||n[r(o)]}},function(i,f,e){var r=e(37),t=e(47),n=e(10),o=e(13);i.exports=e(27)(Array,"Array",function(u,a){this._t=o(u),this._i=0,this._k=a},function(){var u=this._t,a=this._k,s=this._i++;return!u||s>=u.length?(this._t=void 0,t(1)):a=="keys"?t(0,s):a=="values"?t(0,u[s]):t(0,[s,u[s]])},"values"),n.Arguments=n.Array,r("keys"),r("values"),r("entries")},function(i,f){},function(i,f,e){var r,t,n,o=e(28),u=e(2),a=e(7),s=e(21),c=e(23),d=e(9),p=(e(3),e(14)),w=e(38),_=e(40),A=(e(58).set,e(60)),x=e(30).set,b=e(48)(),S="Promise",k=u.TypeError,E=u.process,y=u[S],E=u.process,P=s(E)=="process",M=function(){},T=!!function(){try{var h=y.resolve(1),v=(h.constructor={})[e(1)("species")]=function(m){m(M,M)};return(P||typeof PromiseRejectionEvent=="function")&&h.then(M)instanceof v}catch{}}(),L=function(h,v){return h===v||h===y&&v===n},U=function(h){var v;return!(!d(h)||typeof(v=h.then)!="function")&&v},I=function(h){return L(y,h)?new B(h):new t(h)},B=t=function(h){var v,m;this.promise=new h(function(C,R){if(v!==void 0||m!==void 0)throw k("Bad Promise constructor");v=C,m=R}),this.resolve=p(v),this.reject=p(m)},J=function(h){try{h()}catch(v){return{error:v}}},z=function(h,v){if(!h._n){h._n=!0;var m=h._c;b(function(){for(var C=h._v,R=h._s==1,H=0,K=function(G){var W,ne,$=R?G.ok:G.fail,ee=G.resolve,Z=G.reject,te=G.domain;try{$?(R||(h._h==2&&N(h),h._h=1),$===!0?W=C:(te&&te.enter(),W=$(C),te&&te.exit()),W===G.promise?Z(k("Promise-chain cycle")):(ne=U(W))?ne.call(W,ee,Z):ee(W)):Z(C)}catch(xe){Z(xe)}};m.length>H;)K(m[H++]);h._c=[],h._n=!1,v&&!h._h&&V(h)})}},V=function(h){x.call(u,function(){var v,m,C,R=h._v;if(F(h)&&(v=J(function(){P?E.emit("unhandledRejection",R,h):(m=u.onunhandledrejection)?m({promise:h,reason:R}):(C=u.console)&&C.error&&C.error("Unhandled promise rejection",R)}),h._h=P||F(h)?2:1),h._a=void 0,v)throw v.error})},F=function(h){if(h._h==1)return!1;for(var v,m=h._a||h._c,C=0;m.length>C;)if(v=m[C++],v.fail||!F(v.promise))return!1;return!0},N=function(h){x.call(u,function(){var v;P?E.emit("rejectionHandled",h):(v=u.onrejectionhandled)&&v({promise:h,reason:h._v})})},D=function(h){var v=this;v._d||(v._d=!0,v=v._w||v,v._v=h,v._s=2,v._a||(v._a=v._c.slice()),z(v,!0))},X=function(h){var v,m=this;if(!m._d){m._d=!0,m=m._w||m;try{if(m===h)throw k("Promise can't be resolved itself");(v=U(h))?b(function(){var C={_w:m,_d:!1};try{v.call(h,a(X,C,1),a(D,C,1))}catch(R){D.call(C,R)}}):(m._v=h,m._s=1,z(m,!1))}catch(C){D.call({_w:m,_d:!1},C)}}};T||(y=function(h){w(this,y,S,"_h"),p(h),r.call(this);try{h(a(X,this,1),a(D,this,1))}catch(v){D.call(this,v)}},r=function(h){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=e(56)(y.prototype,{then:function(h,v){var m=I(A(this,y));return m.ok=typeof h!="function"||h,m.fail=typeof v=="function"&&v,m.domain=P?E.domain:void 0,this._c.push(m),this._a&&this._a.push(m),this._s&&z(this,!1),m.promise},catch:function(h){return this.then(void 0,h)}}),B=function(){var h=new r;this.promise=h,this.resolve=a(X,h,1),this.reject=a(D,h,1)}),c(c.G+c.W+c.F*!T,{Promise:y}),e(18)(y,S),e(59)(S),n=e(6)[S],c(c.S+c.F*!T,S,{reject:function(h){var v=I(this),m=v.reject;return m(h),v.promise}}),c(c.S+c.F*(o||!T),S,{resolve:function(h){if(h instanceof y&&L(h.constructor,this))return h;var v=I(this),m=v.resolve;return m(h),v.promise}}),c(c.S+c.F*!(T&&e(46)(function(h){y.all(h).catch(M)})),S,{all:function(h){var v=this,m=I(v),C=m.resolve,R=m.reject,H=J(function(){var K=[],G=0,W=1;_(h,!1,function(ne){var $=G++,ee=!1;K.push(void 0),W++,v.resolve(ne).then(function(Z){ee||(ee=!0,K[$]=Z,--W||C(K))},R)}),--W||C(K)});return H&&R(H.error),m.promise},race:function(h){var v=this,m=I(v),C=m.reject,R=J(function(){_(h,!1,function(H){v.resolve(H).then(m.resolve,C)})});return R&&C(R.error),m.promise}})},function(i,f,e){var r=e(61)(!0);e(27)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,o=this._i;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o),this._i+=t.length,{value:t,done:!1})})},function(i,f,e){e(65);for(var r=e(2),t=e(5),n=e(10),o=e(1)("toStringTag"),u=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],a=0;a<5;a++){var s=u[a],c=r[s],d=c&&c.prototype;d&&!d[o]&&t(d,o,s),n[s]=n.Array}},function(i,f){i.exports=se},function(i,f){i.exports=le}])})})(_e);var Le=_e.exports;q.ipcMain.handle("get-machine-id",()=>Le.machineIdSync());q.ipcMain.handle("save-license",(g,l)=>{const O=q.app.getPath("userData"),j=Y.join(O,"license.txt");return Q.writeFileSync(j,l),!0});q.ipcMain.handle("get-license",()=>{const g=q.app.getPath("userData"),l=Y.join(g,"license.txt");return Q.existsSync(l)?Q.readFileSync(l,"utf-8"):null});De&&q.app.quit();const me=()=>{new q.BrowserWindow({width:1300,height:800,webPreferences:{preload:Y.join(__dirname,"preload.js")}}).loadFile(Y.join(__dirname,"../renderer/main_window/index.html"))};function Ue(){return q.app.isPackaged?Y.dirname(q.app.getPath("exe")):process.cwd()}function We(){const g=Ue(),l=Y.join(g,"template.json"),O=Y.join(process.resourcesPath,"template.json");try{if(!Q.existsSync(l)){if(!Q.existsSync(O))throw new Error(`Bundled template not found at ${O}`);Q.copyFileSync(O,l)}}catch(j){console.error("Failed to ensure template.json:",j)}return l}q.app.whenReady().then(()=>{const g=We();q.ipcMain.handle("get-template-path",()=>g),me(),q.app.on("activate",()=>{q.BrowserWindow.getAllWindows().length===0&&me()})});q.app.on("window-all-closed",()=>{process.platform!=="darwin"&&q.app.quit()});q.ipcMain.handle("print-portrait",async(g,{content:l,url:O})=>{const j=new q.BrowserWindow({show:!1}),i=new URL(O,void 0).toString(),f=`
<!DOCTYPE html>
<html dir="rtl">
<head>
  <meta charset="utf-8">
  <style>
    @page { size: A4 portrait; margin: 0; }
    html, body { margin: 0; padding: 0; width: 210mm; height: 297mm; overflow: hidden; }
    .print-area { 
      width: 210mm;
      height: 297mm;
      position: relative;
      background-image: url('${i}');
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
  </style>
</head>
<body>
  <div class="print-area">
    <img src='${i}' style="width:100%;height:auto" />

    ${l}
  </div>
</body>
</html>
  `;j.loadURL("data:text/html;charset=utf-8,"+encodeURIComponent(f)),j.webContents.on("did-finish-load",()=>{j.webContents.print({silent:!1,printBackground:!0,landscape:!1,margins:{marginType:"none"},pageSize:"A4"},()=>{j.close()})})});
